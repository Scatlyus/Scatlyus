<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sarvos ‚Äî Portais & Intera√ß√µes</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&family=Inter:wght@400;500;700&family=Playfair+Display:wght@500;700&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <style>
    :root{
      /* Paleta Principal - Cores escuras dominam */
      --night:#0B0C10;          /* Noite Profunda - base */
      --obsidian:#1F2833;       /* Azul Obsidiana - secund√°rio */
      --void:#0A0B0F;           /* Vazio m√≠stico - acentos */
      --silver:#C5C6C7;         /* Cinza Prata - texto secund√°rio */
      --pearl:#E8E9EA;          /* P√©rola - texto principal */
      --gold:#f4c20d;           /* Dourado Alqu√≠mico - acento √∫nico */
      --gold-glow:rgba(244,194,13,0.3); /* Brilho dourado */
      --white:#F8F8F8;          /* Branco Et√©reo - destaque */
      
      /* Tokens de Design */
      --radius:22px;
      --radius-sm:12px;
      --radius-lg:28px;
      --shadow:0 20px 60px rgba(0,0,0,.45);
      --shadow-glow:0 0 40px var(--gold-glow);
      --transition:all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --transition-slow:all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
      
      /* Espa√ßamento Generoso */
      --space-xs:4px;
      --space-sm:8px;
      --space-md:16px;
      --space-lg:24px;
      --space-xl:32px;
      --space-2xl:48px;
      --space-3xl:72px;
      
      /* Tipografia Hier√°rquica */
      --font-display:"Cinzel Decorative", "Playfair Display", Georgia, "Times New Roman", serif;
      --font-serif:"Playfair Display", Georgia, "Times New Roman", serif;
      --font-sans:Inter, system-ui, -apple-system, "Segoe UI", Roboto, Ubuntu, Cantarell, "Noto Sans", Arial, "Apple Color Emoji", "Segoe UI Emoji";
      --font-mono:ui-monospace, "SFMono-Regular", Menlo, Consolas, "Courier New", monospace;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; 
      background:
        radial-gradient(1200px 900px at 80% -10%, #22314a 0%, var(--night) 55%),
        linear-gradient(135deg, var(--void) 0%, var(--night) 100%);
      background-attachment: fixed;
      color:var(--pearl); 
      font:500 16px/1.6 var(--font-sans);
      overflow-x:hidden;
      letter-spacing:0.01em;
    }
    
    /* Texturas sutis de fundo */
    body::before{
      content:''; position:fixed; inset:0; pointer-events:none; z-index:-1;
      background-image:
        radial-gradient(circle at 20% 80%, rgba(244,194,13,0.03) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, rgba(244,194,13,0.02) 0%, transparent 50%);
      opacity:0.6;
    }
    
    .wrap{max-width:1120px;margin:0 auto;padding:var(--space-2xl)}
    
    /* Header com hierarquia clara */
    header{
      display:flex;align-items:center;justify-content:space-between;gap:var(--space-md);
      margin-bottom:var(--space-xl);flex-wrap:wrap;
    }
    
    .brand{display:flex;align-items:center;gap:var(--space-md)}
    
    .brand .sigil{
      width:48px;height:48px;border-radius:50%;
      background:
        radial-gradient(circle at 30% 30%, var(--gold), #b08900 55%, transparent 56%), 
        conic-gradient(from 0deg at 50% 50%, var(--gold-glow), transparent 30%, rgba(244,194,13,0.18) 60%, transparent 100%);
      position:relative;
      box-shadow:0 0 40px var(--gold-glow) inset, 0 0 18px var(--gold-glow);
      transition:var(--transition);
    }
    .brand .sigil:hover{transform:scale(1.05); box-shadow:0 0 50px var(--gold-glow) inset, 0 0 25px var(--gold-glow);}
    
    h1{
      margin:0;
      font-family:var(--font-display);
      letter-spacing:0.8px; 
      font-size:28px;
      background:linear-gradient(180deg, var(--gold), #d4b100 60%, #9a7b00);
      -webkit-background-clip:text; 
      background-clip:text; 
      color:transparent;
      text-shadow:0 0 24px rgba(255,215,0,.15);
      font-weight:700;
    }
    
    .sub{
      color:var(--silver);
      font-family:var(--font-serif);
      opacity:0.9;
      font-size:15px;
      letter-spacing:0.02em;
    }

    /* Card base com espa√ßamento generoso */
    .card{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:1px solid rgba(255,255,255,.1); 
      border-radius:var(--radius); 
      box-shadow:var(--shadow);
      transition:var(--transition);
    }
    .card:hover{transform:translateY(-2px); box-shadow:0 25px 70px rgba(0,0,0,.5);}
    
    .hd{
      padding:var(--space-lg) var(--space-xl);
      border-bottom:1px solid rgba(255,255,255,.08);
      display:flex;align-items:center;justify-content:space-between;
    }
    .bd{padding:var(--space-xl)}

    .grid{display:grid;grid-template-columns:1.2fr .8fr;gap:var(--space-lg)}
    @media(max-width:980px){.grid{grid-template-columns:1fr}}

    /* Portais com microintera√ß√µes premium */
    .portals{display:flex;gap:var(--space-lg);flex-wrap:wrap;align-items:center;justify-content:center}
    
    .portal{
      position:relative;
      width:clamp(100px, 22vw, 150px);
      height:clamp(100px, 22vw, 150px);
      border-radius:50%;
      background:
        radial-gradient(circle at 50% 50%, rgba(244,194,13,.15), rgba(244,194,13,0) 70%),
        radial-gradient(80px 80px at 50% 50%, rgba(255,255,255,.06), rgba(255,255,255,0));
      border:2px solid rgba(244,194,13,.5); 
      box-shadow:0 0 40px var(--gold-glow) inset, 0 0 20px var(--gold-glow);
      display:grid;place-items:center; 
      cursor:pointer; 
      transition:var(--transition);
      min-height:44px; /* Acessibilidade - tamanho m√≠nimo de clique */
    }
    
    .portal:hover{
      transform:translateY(-4px) scale(1.02); 
      box-shadow:0 0 60px var(--gold-glow) inset, 0 0 35px var(--gold-glow), 0 10px 30px rgba(0,0,0,.3);
    }
    
    .portal:focus{
      outline:3px solid var(--gold);
      outline-offset:4px;
    }
    
    .portal.locked{
      filter:grayscale(.8) opacity(.6); 
      border-style:dashed;
      cursor:not-allowed;
    }
    /* Popover para portal bloqueado */
    .portal.locked:hover .popover{
      opacity:1; transform:translate(-50%, -8px) scale(1); pointer-events:auto;
    }
    .popover{
      position:absolute; left:50%; top:-12px; transform:translate(-50%, -4px) scale(.98);
      background:rgba(10,11,15,.96); color:var(--pearl);
      border:1px solid rgba(244,194,13,.3); border-radius:10px;
      padding:6px 10px; font-size:12px; white-space:nowrap; pointer-events:none;
      box-shadow:0 8px 24px rgba(0,0,0,.4);
      opacity:0; transition:var(--transition);
    }
    .popover::after{
      content:''; position:absolute; left:50%; bottom:-6px; transform:translateX(-50%);
      width:10px; height:10px; background:rgba(10,11,15,.96); border-left:1px solid rgba(244,194,13,.3); border-bottom:1px solid rgba(244,194,13,.3);
      transform-origin:center; rotate:45deg;
    }
    
    .portal.locked::after{
      content:'üîí'; position:absolute; top:50%; left:50%; transform:translate(-50%, -50%);
      font-size:20px; opacity:0.7;
    }
    
    .portal .title{
      font-family:var(--font-display); 
      text-align:center; 
      padding:0 var(--space-sm); 
      font-size:13px;
      line-height:1.3;
      font-weight:600;
    }
    
    .portal .level{
      position:absolute; 
      top:-10px; 
      right:-10px; 
      width:40px; 
      height:40px; 
      border-radius:50%;
      background:linear-gradient(180deg, var(--gold), #b08900); 
      display:grid; 
      place-items:center; 
      font-weight:800; 
      color:var(--night);
      border:3px solid var(--night);
      font-size:14px;
      box-shadow:0 4px 12px rgba(0,0,0,.3);
    }

    /* Part√≠culas otimizadas com performance */
    .particles{position:absolute; inset:0; pointer-events:none; overflow:hidden; z-index:1}
    .p{position:absolute; width:2px; height:2px; background:var(--gold); opacity:.6; border-radius:50%; filter:blur(.5px); animation:rise linear infinite}
    @keyframes rise{from{transform:translateY(0); opacity:.1}to{transform:translateY(-140vh); opacity:0}}
    @media (prefers-reduced-motion: reduce){ .p{animation:none} }

    /* Mirror com atmosfera ritual√≠stica */
    .mirror{
      position:relative; 
      border-radius:var(--radius-lg); 
      padding:var(--space-xl); 
      background:
        linear-gradient(180deg, rgba(244,194,13,.08), rgba(255,255,255,.04)),
        radial-gradient(circle at 50% 0%, rgba(244,194,13,.05), transparent 70%);
      border:2px solid rgba(244,194,13,.4); 
      box-shadow: 
        inset 0 0 50px rgba(244,194,13,.1), 
        0 15px 50px rgba(0,0,0,.4),
        0 0 30px rgba(244,194,13,.1);
      transition:var(--transition);
    }
    .mirror:hover{box-shadow: inset 0 0 60px rgba(244,194,13,.15), 0 20px 60px rgba(0,0,0,.5), 0 0 40px rgba(244,194,13,.15);}
    
    .mirror h3{
      margin:0 0 var(--space-md); 
      font-family:var(--font-display);
      font-size:20px;
      color:var(--gold);
      text-shadow:0 0 20px var(--gold-glow);
    }
    
    .mirror .msg{
      min-height:160px; 
      color:var(--pearl);
      font-size:16px;
      line-height:1.6;
      font-family:var(--font-serif);
      font-style:italic;
    }
    
    /* Toolbar com microintera√ß√µes */
    .toolbar{display:flex; gap:var(--space-sm); margin-top:var(--space-lg); flex-wrap:wrap}
    
    .btn{
      cursor:pointer; 
      border:2px solid rgba(255,255,255,.2); 
      background:rgba(255,255,255,.08); 
      color:var(--pearl); 
      padding:var(--space-md) var(--space-lg); 
      border-radius:var(--radius-sm); 
      font-weight:600;
      font-size:14px;
      transition:var(--transition);
      min-height:44px;
      display:flex;align-items:center;gap:var(--space-sm);
    }
    
    .btn:hover{
      background:rgba(255,255,255,.12);
      border-color:rgba(244,194,13,.4);
      transform:translateY(-1px);
      box-shadow:0 4px 12px rgba(0,0,0,.2);
    }
    
    .btn:focus{
      outline:3px solid var(--gold);
      outline-offset:2px;
    }
    
    .btn.primary{
      background:linear-gradient(180deg, var(--gold), #caa800); 
      color:var(--night); 
      border:none;
      font-weight:700;
      box-shadow:0 4px 15px rgba(244,194,13,.3);
      position:relative;
      overflow:hidden;
    }
    .btn.primary::before{
      content:''; position:absolute; inset:0;
      background:linear-gradient(45deg, transparent 30%, rgba(255,255,255,.2) 50%, transparent 70%);
      transform:translateX(-100%); transition:transform 0.6s;
    }
    .btn.primary:hover::before{transform:translateX(100%);}
    .btn.primary:hover{
      background:linear-gradient(180deg, #ffd700, #b8941f);
      transform:translateY(-2px) scale(1.02);
      box-shadow:0 6px 20px rgba(244,194,13,.4), 0 0 30px rgba(244,194,13,.2);
    }
    .btn.primary:active{transform:translateY(0) scale(0.98);}
    
    /* Anima√ß√£o de pulsar para CTA principal */
    .btn.primary.pulse{
      animation:pulseGlow 2s ease-in-out infinite;
    }
    @keyframes pulseGlow{
      0%, 100% { box-shadow:0 4px 15px rgba(244,194,13,.3), 0 0 20px rgba(244,194,13,.1); }
      50% { box-shadow:0 4px 15px rgba(244,194,13,.5), 0 0 30px rgba(244,194,13,.3); }
    }
    
    .btn.ghost{background:transparent; border-color:rgba(255,255,255,.3);}
    .btn.ghost:hover{background:rgba(255,255,255,.05);}
    
    .btn.toggle-active{
      outline:3px solid var(--gold);
      box-shadow:0 0 20px var(--gold-glow);
      background:rgba(244,194,13,.1);
      border-color:var(--gold);
    }

    /* Grim√≥rio com atmosfera m√≠stica */
    .log{
      --row:rgba(255,255,255,.04); 
      --bd:rgba(255,255,255,.07); 
      background:
        linear-gradient(180deg, var(--row), transparent),
        radial-gradient(circle at 50% 0%, rgba(244,194,13,.02), transparent 50%);
      border:1px dashed var(--bd);
      border-radius:var(--radius-sm); 
      padding:var(--space-lg); 
      font-family:var(--font-mono); 
      font-size:13px; 
      max-height:400px; 
      overflow:auto;
      line-height:1.5;
    }
    .log-entry{
      padding:var(--space-sm) var(--space-md); 
      border-bottom:1px dashed rgba(255,255,255,.06);
      transition:var(--transition);
    }
    .log-entry:hover{background:rgba(244,194,13,.05);}

    /* Divisores alqu√≠micos simb√≥licos */
    .divider{
      height:2px; 
      background:linear-gradient(90deg, transparent, var(--gold), rgba(244,194,13,.3), var(--gold), transparent); 
      margin:var(--space-xl) 0;
      position:relative;
    }
    .divider::before{
      content:'‚ú¶'; position:absolute; left:50%; top:50%; transform:translate(-50%, -50%);
      background:var(--night); padding:0 var(--space-sm); color:var(--gold);
      font-size:12px;
      animation:twinkle 3s ease-in-out infinite;
    }
    @keyframes twinkle{
      0%, 100% { opacity:0.6; transform:translate(-50%, -50%) scale(1); }
      50% { opacity:1; transform:translate(-50%, -50%) scale(1.1); }
    }
    
    /* √çcones simb√≥licos adicionais */
    .symbolic-icon{
      display:inline-block; margin:0 var(--space-xs);
      color:var(--gold); opacity:0.7;
      font-size:14px;
      animation:float 4s ease-in-out infinite;
    }
    @keyframes float{
      0%, 100% { transform:translateY(0); }
      50% { transform:translateY(-2px); }
    }

    /* Hero com atmosfera ritual√≠stica */
    .hero{
      position:relative; 
      border-radius:var(--radius-lg); 
      padding:var(--space-3xl) var(--space-2xl); 
      background:
        radial-gradient(800px 400px at 50% 0%, rgba(244,194,13,.12), rgba(244,194,13,0)),
        linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02));
      border:2px solid rgba(244,194,13,.2); 
      box-shadow:var(--shadow), 0 0 40px rgba(244,194,13,.1); 
      text-align:center; 
      display:grid; 
      place-items:center;
      transition:var(--transition);
    }
    .hero:hover{
      box-shadow:0 25px 80px rgba(0,0,0,.5), 0 0 60px rgba(244,194,13,.15);
      transform:translateY(-2px);
    }
    
    .hero h2{
      font-family:var(--font-display); 
      font-size:38px; 
      margin:0 0 var(--space-md); 
      letter-spacing:0.6px;
      background:linear-gradient(180deg, var(--gold), #d4b100 60%, #9a7b00); 
      -webkit-background-clip:text; 
      background-clip:text; 
      color:transparent;
      text-shadow:0 0 30px var(--gold-glow);
    }
    
    .hero p{
      font-family:var(--font-serif); 
      color:var(--silver); 
      margin:0 0 var(--space-xl);
      font-size:18px;
      line-height:1.6;
      font-style:italic;
    }
    
    /* Frases-chave em it√°lico elegante */
    .highlight-phrase{
      font-style:italic;
      color:var(--gold);
      text-shadow:0 0 10px rgba(244,194,13,.3);
      font-weight:500;
    }

    /* Cards de planos balanceados */
    .pricing{display:grid; gap:var(--space-lg)}
    .price-card{
      background:
        linear-gradient(180deg, rgba(31,40,51,.7), rgba(31,40,51,.4)),
        radial-gradient(circle at 50% 0%, rgba(244,194,13,.03), transparent 50%);
      border:1px solid rgba(255,255,255,.1); 
      border-radius:var(--radius); 
      padding:var(--space-xl); 
      line-height:1.6;
      transition:var(--transition);
    }
    .price-card:hover{
      transform:translateY(-2px);
      box-shadow:0 10px 30px rgba(0,0,0,.3);
      border-color:rgba(244,194,13,.3);
    }
    
    .kpis{display:flex; gap:var(--space-sm); flex-wrap:wrap; color:var(--silver)}
    .kpi{
      padding:var(--space-sm) var(--space-md); 
      border-radius:999px; 
      border:1px solid rgba(255,255,255,.2); 
      background:rgba(255,255,255,.08);
      font-size:12px;
      font-weight:500;
      transition:var(--transition);
    }
    .kpi:hover{background:rgba(244,194,13,.1); border-color:rgba(244,194,13,.4);}

    /* Breadcrumbs discretos */
    .breadcrumb{
      display:flex; align-items:center; gap:var(--space-sm);
      color:var(--silver); font-size:13px; margin-bottom:var(--space-md);
    }
    .breadcrumb span{opacity:0.6}
    .breadcrumb .current{color:var(--gold); font-weight:600;}

    footer{margin-top:var(--space-2xl); color:var(--silver); font-size:12px; text-align:center; opacity:0.8}
    
    /* Modal com transi√ß√µes suaves */
    .modal{
      position:fixed; inset:0; 
      background:rgba(11,12,16,.85); 
      display:none; 
      align-items:center; 
      justify-content:center; 
      padding:var(--space-xl); 
      z-index:9999;
      backdrop-filter:blur(8px);
    }
    .modal.show{display:flex; animation:fadeIn 0.3s ease;}
    @keyframes fadeIn{from{opacity:0} to{opacity:1}}
    
    .dialog{
      max-width:920px; width:100%; 
      background:
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.03)),
        radial-gradient(circle at 50% 0%, rgba(244,194,13,.05), transparent 50%);
      border:2px solid rgba(255,255,255,.15); 
      border-radius:var(--radius-lg); 
      box-shadow:0 40px 100px rgba(0,0,0,.7), 0 0 50px rgba(244,194,13,.1);
      animation:slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }
    @keyframes slideUp{from{transform:translateY(30px); opacity:0} to{transform:translateY(0); opacity:1}}
    
    .dialog .hd{border-bottom:1px solid rgba(255,255,255,.1); padding:var(--space-xl)}
    .close{
      cursor:pointer; 
      border:2px solid rgba(255,255,255,.2); 
      background:rgba(255,255,255,.08); 
      color:var(--pearl); 
      padding:var(--space-sm) var(--space-md); 
      border-radius:var(--radius-sm); 
      font-weight:600;
      transition:var(--transition);
    }
    .close:hover{background:rgba(255,255,255,.12); border-color:rgba(244,194,13,.4);}

    /* Breakpoints responsivos */
    /* Tablet */
    @media(max-width:980px){
      .grid{grid-template-columns:1fr; gap:var(--space-md)}
      .portals{gap:var(--space-md)}
      .hero{padding:var(--space-2xl) var(--space-lg)}
    }
    
    /* Mobile */
    @media(max-width:720px){
      .grid{display:block}
      #interaction .card + aside{margin-top:var(--space-lg)}
      .portals{justify-content:center; gap:var(--space-sm)}
      .portal{width:clamp(80px, 18vw, 120px); height:clamp(80px, 18vw, 120px);}
      .hero{padding:var(--space-xl) var(--space-md)}
      .hero h2{font-size:28px}
      .hero p{font-size:16px}
      .wrap{padding:var(--space-lg)}
      .btn{padding:var(--space-sm) var(--space-md); font-size:13px}
      .toolbar{gap:var(--space-xs)}
    }
    
    /* Mobile pequeno */
    @media(max-width:480px){
      .wrap{padding:var(--space-md)}
      .hero{padding:var(--space-lg) var(--space-sm)}
      .hero h2{font-size:24px}
      .portal{width:clamp(70px, 16vw, 100px); height:clamp(70px, 16vw, 100px);}
      .portal .title{font-size:11px; padding:0 var(--space-xs)}
      .btn{padding:var(--space-xs) var(--space-sm); font-size:12px}
    }
    
    /* Transi√ß√µes entre telas */
    .fade-in{animation:fadeIn 0.5s ease;}
    .slide-in{animation:slideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);}
    @keyframes slideIn{from{transform:translateX(-20px); opacity:0} to{transform:translateX(0); opacity:1}}
  </style>
</head>
<body>
  <div class="particles" id="particles" aria-hidden="true"></div>
  <!-- SVG Symbols: √çcones alqu√≠micos -->
  <svg xmlns="http://www.w3.org/2000/svg" style="position:absolute; width:0; height:0; overflow:hidden" aria-hidden="true">
    <symbol id="icon-mic" viewBox="0 0 24 24">
      <path d="M12 14a4 4 0 0 0 4-4V7a4 4 0 0 0-8 0v3a4 4 0 0 0 4 4z"/>
      <path d="M5 11a7 7 0 0 0 14 0" fill="none" stroke="currentColor" stroke-width="2"/>
      <path d="M12 18v3" fill="none" stroke="currentColor" stroke-width="2"/>
    </symbol>
    <symbol id="icon-pen" viewBox="0 0 24 24">
      <path d="M3 17.25V21h3.75L18.81 8.94l-3.75-3.75L3 17.25z"/>
      <path d="M20.71 7.04a1 1 0 0 0 0-1.41l-2.34-2.34a1 1 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
    </symbol>
    <symbol id="icon-cam" viewBox="0 0 24 24">
      <path d="M3 7h11a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2z"/>
      <path d="M21 8l-4 3v2l4 3V8z"/>
    </symbol>
  </svg>
  <div class="wrap">
    <header>
      <div class="brand">
        <div class="sigil" aria-hidden="true"></div>
        <div>
          <h1>Sarvos ‚Äî Cada palavra √© um espelho</h1>
          <div class="sub">"Voc√™ est√° pronto para atravessar o portal?"</div>
        </div>
      </div>
      <button class="btn primary" id="goLevels" aria-label="Entrar no Templo">Entrar no Templo</button>
    </header>

    <!-- HOME / HERO -->
    <section class="hero card fade-in" id="home">
      <h2>Eco dos Portais</h2>
      <p>Em cada <span class="highlight-phrase">palavra</span>, um universo se revela. Em cada <span class="highlight-phrase">sil√™ncio</span>, uma verdade se esconde.</p>
      <button class="btn primary" id="startNv0" aria-label="Atravessar o portal inicial">Atravessar</button>
    </section>

    <div class="divider"></div>

    <!-- LEVELS / PORTALS -->
    <section class="card slide-in" id="levels" style="display:none">
      <div class="hd">
        <strong style="font-family:var(--font-display)">Portais</strong>
        <div style="color:var(--silver)">Passe o mouse/toque <span class="symbolic-icon">‚ú¶</span> os portais respiram.</div>
      </div>
      <div class="bd">
        <div class="portals" role="list">
          <!-- 0..4 -->
          <div class="portal" data-level="0" id="p0" role="button" tabindex="0" aria-label="Abrir Nv 0 ‚Äî Eco dos Portais" title="Portal dispon√≠vel - Eco dos Portais"><span class="title">Nv 0 ‚Äî Eco dos Portais</span><span class="level">0</span></div>
          <div class="portal locked" data-level="1" id="p1" role="button" tabindex="0" aria-label="Portal bloqueado - Nv 01 ‚Äî Aprendiz das Letras" title="Portal bloqueado - Complete o n√≠vel anterior"><span class="title">Nv 01 ‚Äî Aprendiz das Letras</span><span class="level">1</span><span class="popover">Complete o n√≠vel anterior para abrir</span></div>
          <div class="portal locked" data-level="2" id="p2" role="button" tabindex="0" aria-label="Portal bloqueado - Nv 02 ‚Äî Guardi√£o do Verbo" title="Portal bloqueado - Complete o n√≠vel anterior"><span class="title">Nv 02 ‚Äî Guardi√£o do Verbo</span><span class="level">2</span><span class="popover">Complete o n√≠vel anterior para abrir</span></div>
          <div class="portal locked" data-level="3" id="p3" role="button" tabindex="0" aria-label="Portal bloqueado - Nv 03 ‚Äî Esculpidor de Frases" title="Portal bloqueado - Complete o n√≠vel anterior"><span class="title">Nv 03 ‚Äî Esculpidor de Frases</span><span class="level">3</span><span class="popover">Complete o n√≠vel anterior para abrir</span></div>
          <div class="portal locked" data-level="4" id="p4" role="button" tabindex="0" aria-label="Portal bloqueado - Nv 04 ‚Äî Transcritor do Invis√≠vel" title="Portal bloqueado - Complete o n√≠vel anterior"><span class="title">Nv 04 ‚Äî Transcritor do Invis√≠vel</span><span class="level">4</span><span class="popover">Complete o n√≠vel anterior para abrir</span></div>
        </div>
      </div>
    </section>

    <div class="divider"></div>

    <!-- INTERACTION / MIRROR -->
    <section class="grid" id="interaction" style="display:none">
      <div class="card slide-in" data-section="mirror">
        <div class="hd">
          <strong style="font-family:var(--font-display)" id="mirrorTitle">Espelho M√°gico</strong>
          <div class="breadcrumb" id="breadcrumb" style="display:none">
            <span>Voc√™ est√° em:</span>
            <span class="current" id="currentLevel">Nv 0</span>
            <span>></span>
            <span>Espelho</span>
          </div>
        </div>
        <div class="bd">
          <div class="mirror" id="mirror">
            <h3 id="mirrorHeading">Nv 0 ‚Äî Eco dos Portais</h3>
            <div class="msg" id="mirrorMsg">"Sussurre o seu primeiro verbo."</div>
            <div class="toolbar">
              <button class="btn" id="mic" aria-pressed="false" aria-label="Ativar microfone para grava√ß√£o de √°udio">
                <svg width="18" height="18" aria-hidden="true"><use href="#icon-mic"/></svg> Microfone
              </button>
              <button class="btn" id="pen" aria-pressed="false" aria-label="Ativar modo de escrita de texto">
                <svg width="18" height="18" aria-hidden="true"><use href="#icon-pen"/></svg> Escrever
              </button>
              <button class="btn" id="cam" aria-pressed="false" aria-label="Ativar grava√ß√£o de v√≠deo">
                <svg width="18" height="18" aria-hidden="true"><use href="#icon-cam"/></svg> V√≠deo
              </button>
              <button class="btn primary" id="send" aria-label="Enviar mensagem para o espelho">Invocar</button>
            </div>
          </div>
        </div>
      </div>
      <aside class="card" data-section="grimorio">
        <div class="hd"><strong>Grim√≥rio</strong></div>
        <div class="bd">
          <div class="log" id="log" role="log" aria-live="polite"></div>
          <div class="divider"></div>
          <div class="pricing" id="pricing" style="display:none">
            <div class="price-card">
              <div style="font-family:'Cinzel Decorative',serif; margin-bottom:6px">Nv 01 ‚Äî Aprendiz das Letras</div>
              <div style="font-family:'Playfair Display',serif; color:var(--silver); margin-bottom:8px">Quem escreve para si, come√ßa a lembrar de quem √©.</div>
              <div class="kpis">
                <span class="kpi">20 intera√ß√µes/m√™s</span>
                <span class="kpi">Somente texto</span>
                <span class="kpi">R$ 29,90</span>
              </div>
              <div style="margin-top:10px; display:flex; gap:8px">
                <button class="btn primary" id="startLv1">üîÆ Iniciar Escrita</button>
                <button class="btn ghost" id="viewPlans">Ver planos</button>
              </div>
            </div>
          </div>
          <div class="toolbar" id="mobileTabs" style="display:none; margin-top:10px">
            <button class="btn" data-tab="mirror">Espelho</button>
            <button class="btn" data-tab="grimorio">Grim√≥rio</button>
          </div>
        </div>
      </aside>
    </section>

    <footer>Use este HTML em um n√≥ <em>Respond to Webhook</em> do n8n com <code>Content-Type: text/html</code>. √çcones alqu√≠micos aparecem como divisores e brilhos dourados simbolizam a travessia.</footer>

    <!-- PLANS PAGE -->
    <section class="card" id="plans" style="display:none; margin-top:16px">
      <div class="hd">
        <strong style="font-family:'Cinzel Decorative',serif">Planos Sarvos</strong>
        <div style="color:var(--silver)">Escolha seu portal de inicia√ß√£o</div>
      </div>
      <div class="bd">
        <div class="pricing" style="grid-template-columns:repeat(auto-fit,minmax(260px,1fr))">
          <div class="price-card">
            <div style="font-family:'Cinzel Decorative',serif; margin-bottom:6px">Nv 0 ‚Äî Eco dos Portais</div>
            <div class="kpis">
              <span class="kpi">4 intera√ß√µes/m√™s</span>
              <span class="kpi">Texto</span>
              <span class="kpi">1/dia</span>
              <span class="kpi">Gratuito</span>
            </div>
            <div style="margin-top:10px"><button class="btn primary" data-plan="nv0">Entrar</button></div>
          </div>
          <div class="price-card">
            <div style="font-family:'Cinzel Decorative',serif; margin-bottom:6px">Nv 01 ‚Äî Aprendiz das Letras</div>
            <div class="kpis">
              <span class="kpi">20 intera√ß√µes/m√™s</span>
              <span class="kpi">Texto</span>
              <span class="kpi">1/dia</span>
              <span class="kpi">R$ 29,90</span>
            </div>
            <div style="margin-top:10px"><button class="btn primary" data-plan="nv1">Assinar</button></div>
          </div>
          <div class="price-card">
            <div style="font-family:'Cinzel Decorative',serif; margin-bottom:6px">Nv 02 ‚Äî Guardi√£o do Verbo</div>
            <div class="kpis">
              <span class="kpi">40 intera√ß√µes/m√™s</span>
              <span class="kpi">Texto + √Åudio</span>
              <span class="kpi">2/dia</span>
              <span class="kpi">R$ 49,90</span>
            </div>
            <div style="margin-top:10px"><button class="btn primary" data-plan="nv2">Assinar</button></div>
          </div>
          <div class="price-card">
            <div style="font-family:'Cinzel Decorative',serif; margin-bottom:6px">Nv 03 ‚Äî Esculpidor de Frases</div>
            <div class="kpis">
              <span class="kpi">60 intera√ß√µes/m√™s</span>
              <span class="kpi">Texto + √Åudio</span>
              <span class="kpi">2/dia</span>
              <span class="kpi">R$ 69,90</span>
            </div>
            <div style="margin-top:10px"><button class="btn primary" data-plan="nv3">Assinar</button></div>
          </div>
          <div class="price-card">
            <div style="font-family:'Cinzel Decorative',serif; margin-bottom:6px">Nv 04 ‚Äî Transcritor do Invis√≠vel</div>
            <div class="kpis">
              <span class="kpi">80 intera√ß√µes/m√™s</span>
              <span class="kpi">Texto + √Åudio/V√≠deo</span>
              <span class="kpi">4/dia</span>
              <span class="kpi">R$ 99,90</span>
            </div>
            <div style="margin-top:10px"><button class="btn primary" data-plan="nv4">Assinar</button></div>
          </div>
        </div>

        <div class="divider"></div>
        <div style="display:grid; gap:12px">
          <div class="price-card">
            <div style="font-family:'Cinzel Decorative',serif; margin-bottom:6px">Rollover de Cr√©ditos</div>
            <div style="color:var(--silver)">At√© 20% das intera√ß√µes n√£o usadas rolam para o m√™s seguinte (expiram ao final do m√™s seguinte).</div>
          </div>
          <div class="price-card">
            <div style="font-family:'Cinzel Decorative',serif; margin-bottom:6px">Add‚Äëons</div>
            <div class="kpis">
              <span class="kpi">√Åudio 10√ó2min ‚Äî R$ 9,90</span>
              <span class="kpi">√Åudio 20√ó2min ‚Äî R$ 19,90</span>
              <span class="kpi">√Åudio 20√ó4min ‚Äî R$ 29,90</span>
            </div>
          </div>
          <div class="price-card">
            <div style="font-family:'Cinzel Decorative',serif; margin-bottom:6px">Modo Vig√≠lia Compassiva (Profissionais)</div>
            <div style="color:var(--silver)">Compartilhe, com consentimento, o hist√≥rico simb√≥lico do cliente com um profissional autorizado. Requer Nv 02+.</div>
          </div>
        </div>
      </div>
    </section>

  </div>

  <!-- MODAL: planos por n√≠vel / cat√°logo -->
  <div class="modal" id="modal" aria-hidden="true" aria-modal="true" role="dialog">
    <div class="dialog">
      <div class="hd">
        <strong style="font-family:'Cinzel Decorative',serif" id="modalTitle">Planos Sarvos</strong>
        <button class="close" id="modalClose" aria-label="Fechar">Fechar</button>
      </div>
      <div class="bd" id="modalBody"></div>
    </div>
  </div>

  <audio id="snd" preload="auto">
    <source src="https://assets.mixkit.co/active_storage/sfx/2000/2000-preview.mp3" type="audio/mpeg">
  </audio>

  <script>
    (function (global) {
      'use strict';

      const elements = {
        home: document.getElementById('home'),
        levels: document.getElementById('levels'),
        interaction: document.getElementById('interaction'),
        goLevels: document.getElementById('goLevels'),
        startNv0: document.getElementById('startNv0'),
        p0: document.getElementById('p0'),
        p1: document.getElementById('p1'),
        p2: document.getElementById('p2'),
        p3: document.getElementById('p3'),
        p4: document.getElementById('p4'),
        logBox: document.getElementById('log'),
        pricing: document.getElementById('pricing'),
        plans: document.getElementById('plans'),
        mirrorHeading: document.getElementById('mirrorHeading'),
        mirrorMsg: document.getElementById('mirrorMsg'),
        mirror: document.getElementById('mirror'),
        modal: document.getElementById('modal'),
        modalBody: document.getElementById('modalBody'),
        modalTitle: document.getElementById('modalTitle'),
        modalClose: document.getElementById('modalClose'),
        startLv1: document.getElementById('startLv1'),
        viewPlans: document.getElementById('viewPlans'),
        send: document.getElementById('send'),
        breadcrumb: document.getElementById('breadcrumb'),
        currentLevel: document.getElementById('currentLevel'),
        mobileTabs: document.getElementById('mobileTabs')
      };

      function show(el) {
        if (el) {
          el.style.display = '';
        }
      }

      function hide(el) {
        if (el) {
          el.style.display = 'none';
        }
      }

      function safeSetText(element, text) {
        if (element) {
          element.textContent = text;
        }
      }

      function clampLogHistory(max) {
        const box = elements.logBox;
        if (!box) {
          return;
        }

        const entries = box.querySelectorAll('.log-entry');
        if (entries.length > max) {
          const excess = entries.length - max;
          for (let i = 0; i < excess; i += 1) {
            if (box.firstChild) {
              box.removeChild(box.firstChild);
            }
          }
        }
      }

      function log(message) {
        if (!elements.logBox) {
          return;
        }

        const row = document.createElement('div');
        row.className = 'log-entry';
        const time = new Date().toLocaleTimeString();
        row.innerHTML = `<span style="color:var(--gold)">[${time}]</span> ${message}`;
        elements.logBox.appendChild(row);
        elements.logBox.scrollTop = elements.logBox.scrollHeight;

        row.style.animation = 'slideIn 0.3s ease';
        setTimeout(() => {
          row.style.animation = '';
        }, 300);

        clampLogHistory(200);
      }

      function showFeedback(message, type) {
        const notification = document.createElement('div');
        notification.style.cssText = `
          position: fixed; top: 20px; right: 20px; z-index: 10000;
          background: ${type === 'error' ? 'rgba(220, 38, 38, 0.9)' : 'rgba(244, 194, 13, 0.9)'};
          color: var(--night); padding: var(--space-md) var(--space-lg);
          border-radius: var(--radius-sm); font-weight: 600;
          box-shadow: 0 8px 25px rgba(0,0,0,.3);
          animation: slideIn 0.3s ease;
        `;
        notification.textContent = message;
        document.body.appendChild(notification);
        setTimeout(() => {
          notification.style.animation = 'slideOut 0.3s ease';
          setTimeout(() => notification.remove(), 300);
        }, 3000);
      }

      function updateBreadcrumb(level) {
        if (!elements.breadcrumb || !elements.currentLevel) {
          return;
        }
        elements.breadcrumb.style.display = 'flex';
        elements.currentLevel.textContent = `Nv ${level}`;
      }

      function renderPlanCard(data) {
        const perks = data.perks.map((perk) => `<span class="kpi">${perk}</span>`).join('');
        return `
          <div class="price-card">
            <div style="font-family:'Cinzel Decorative',serif; margin-bottom:6px">${data.title}</div>
            <div style="font-family:'Playfair Display',serif; color:var(--silver); margin-bottom:8px">${data.blurb}</div>
            <div class="kpis">${perks}<span class="kpi">${data.price}</span></div>
            <div style="margin-top:10px">
              <button class="btn primary" data-plan="nv${data.lvl}">Selecionar</button>
            </div>
          </div>
        `;
      }

      function openModal(title, bodyHtml) {
        if (elements.modalTitle) {
          elements.modalTitle.textContent = title;
        }
        if (elements.modalBody) {
          elements.modalBody.innerHTML = bodyHtml;
        }
        if (elements.modal) {
          elements.modal.classList.add('show');
          elements.modal.setAttribute('aria-hidden', 'false');
        }
      }

      function closeModal() {
        if (elements.modal) {
          elements.modal.classList.remove('show');
          elements.modal.setAttribute('aria-hidden', 'true');
        }
      }

      global.UI = {
        elements,
        show,
        hide,
        safeSetText,
        log,
        showFeedback,
        updateBreadcrumb,
        renderPlanCard,
        openModal,
        closeModal
      };
    }(window));

    (function (global) {
      'use strict';

      const ui = global.UI || {};
      const elements = ui.elements || {};
      const log = typeof ui.log === 'function' ? ui.log : function () {};
      const showFeedback = typeof ui.showFeedback === 'function' ? ui.showFeedback : function () {};

      let stylesInjected = false;

      function ensureAnimationStyles() {
        if (stylesInjected) {
          return;
        }
        const style = document.createElement('style');
        style.textContent = `
          @keyframes particleRise {
            0% { transform: translateY(0) scale(1); opacity: 1; }
            100% { transform: translateY(-60px) scale(0); opacity: 0; }
          }
          @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
          }
        `;
        document.head.appendChild(style);
        stylesInjected = true;
      }

      function initParticles() {
        const particles = document.getElementById('particles');
        if (!particles || particles.dataset.initialized === 'true') {
          return;
        }

        const isMobile = matchMedia('(max-width: 720px)').matches;
        const reduced = matchMedia('(prefers-reduced-motion: reduce)').matches;
        const lowEnd = navigator.hardwareConcurrency && navigator.hardwareConcurrency <= 2;

        let total = 0;
        if (!reduced) {
          if (isMobile) {
            total = 24;
          } else if (lowEnd) {
            total = 45;
          } else {
            total = 90;
          }
        }

        for (let i = 0; i < total; i += 1) {
          const particle = document.createElement('div');
          particle.className = 'p';
          particle.style.left = `${Math.random() * 100}vw`;
          particle.style.bottom = `${-10 + Math.random() * 20}vh`;
          particle.style.animationDuration = `${16 + Math.random() * 20}s`;
          particle.style.willChange = 'transform, opacity';
          particles.appendChild(particle);
        }

        if (total > 0 && !document.getElementById('particlesToggle')) {
          const toggleBtn = document.createElement('button');
          toggleBtn.id = 'particlesToggle';
          toggleBtn.innerHTML = '‚ú®';
          toggleBtn.style.cssText = `
            position:fixed; top:20px; left:20px; z-index:1000;
            background:rgba(0,0,0,.5); border:1px solid var(--gold);
            color:var(--gold); width:40px; height:40px; border-radius:50%;
            cursor:pointer; font-size:16px; opacity:0.7;
            transition:opacity 0.3s ease;
          `;
          toggleBtn.title = 'Desligar part√≠culas';
          toggleBtn.addEventListener('click', () => {
            particles.style.display = particles.style.display === 'none' ? '' : 'none';
            toggleBtn.style.opacity = particles.style.display === 'none' ? '0.3' : '0.7';
          });
          document.body.appendChild(toggleBtn);
        }

        particles.dataset.initialized = 'true';
      }

      function initPortalBreathing() {
        const portals = document.querySelectorAll('.portal');
        portals.forEach((portal) => {
          if (portal.animate) {
            portal.animate([
              { boxShadow: '0 0 40px rgba(255,215,0,.15) inset, 0 0 20px rgba(255,215,0,.15)' },
              { boxShadow: '0 0 70px rgba(255,215,0,.32) inset, 0 0 30px rgba(255,215,0,.32)' },
              { boxShadow: '0 0 40px rgba(255,215,0,.15) inset, 0 0 20px rgba(255,215,0,.15)' }
            ], { duration: 2600, iterations: Infinity });
          }
        });
      }

      function createSendEffect() {
        const mirror = elements.mirror;
        if (!mirror) {
          return;
        }

        const glow = document.createElement('div');
        glow.style.cssText = `
          position:absolute; inset:-4px; border-radius:var(--radius-lg);
          box-shadow:0 0 0 0 var(--gold-glow);
          transition: box-shadow .8s cubic-bezier(0.4, 0, 0.2, 1);
          pointer-events:none; z-index:10;
        `;
        mirror.appendChild(glow);

        setTimeout(() => {
          glow.style.boxShadow = '0 0 0 25px rgba(244,194,13,0)';
        }, 10);

        for (let i = 0; i < 8; i += 1) {
          const particle = document.createElement('div');
          particle.style.cssText = `
            position:absolute; width:4px; height:4px; background:var(--gold);
            border-radius:50%; pointer-events:none; z-index:11;
            left:${50 + (Math.random() - 0.5) * 100}%;
            top:${50 + (Math.random() - 0.5) * 100}%;
            animation:particleRise 1.2s ease-out forwards;
          `;
          mirror.appendChild(particle);
          setTimeout(() => particle.remove(), 1200);
        }

        const sound = document.getElementById('snd');
        if (sound) {
          try {
            sound.currentTime = 0;
            sound.play();
          } catch (err) {
            // ignore playback errors
          }
        }

        setTimeout(() => {
          if (glow.parentNode) {
            glow.remove();
          }
        }, 800);

        log('Mensagem invocada ‚ú® (energia dourada liberada)');
        showFeedback('Mensagem enviada ao espelho', 'info');
      }

      global.Anim = {
        ensureAnimationStyles,
        initParticles,
        initPortalBreathing,
        createSendEffect
      };
    }(window));

    (function (global) {
      'use strict';

      const UI = global.UI || {};
      const Anim = global.Anim || {};

      const {
        elements = {},
        show = function () {},
        hide = function () {},
        safeSetText = function () {},
        log = function () {},
        showFeedback = function () {},
        updateBreadcrumb = function () {},
        renderPlanCard = function () { return ''; },
        openModal = function () {},
        closeModal = function () {}
      } = UI;

      const {
        ensureAnimationStyles = function () {},
        initParticles = function () {},
        initPortalBreathing = function () {},
        createSendEffect = function () {}
      } = Anim;

      const levelsData = [
        { lvl: 0, title: 'Nv 0 ‚Äî Eco dos Portais', blurb: 'Entrada ao templo. Experimente a travessia.', price: 'Gratuito', perks: ['4 intera√ß√µes/m√™s', 'Texto', '1/dia'] },
        { lvl: 1, title: 'Nv 01 ‚Äî Aprendiz das Letras', blurb: 'Quem escreve para si, come√ßa a lembrar de quem √©.', price: 'R$ 29,90', perks: ['20 intera√ß√µes/m√™s', 'Texto', '1/dia'] },
        { lvl: 2, title: 'Nv 02 ‚Äî Guardi√£o do Verbo', blurb: 'Camada de profundidade com √°udio.', price: 'R$ 49,90', perks: ['40 intera√ß√µes/m√™s', 'Texto + √Åudio', '2/dia'] },
        { lvl: 3, title: 'Nv 03 ‚Äî Esculpidor de Frases', blurb: 'Mentoria simb√≥lica mais frequente.', price: 'R$ 69,90', perks: ['60 intera√ß√µes/m√™s', 'Texto + √Åudio', '2/dia'] },
        { lvl: 4, title: 'Nv 04 ‚Äî Transcritor do Invis√≠vel', blurb: 'Camadas avan√ßadas com v√≠deo e transcri√ß√µes m√≠sticas.', price: 'R$ 99,90', perks: ['80 intera√ß√µes/m√™s', 'Texto + √Åudio/V√≠deo', '4/dia'] }
      ];

      let currentLevel = 0;
      const unlockedLevels = [0];
      let initialized = false;
      let listenersAttached = false;

      function findClosest(target, selector) {
        if (!target || typeof target.closest !== 'function') {
          return null;
        }
        return target.closest(selector);
      }

      function checkPortalAccess(level) {
        if (!unlockedLevels.includes(level)) {
          showFeedback('Complete o n√≠vel anterior primeiro', 'error');
          return false;
        }
        return true;
      }

      function goToLevels() {
        try {
          hide(elements.home);
          show(elements.levels);
          hide(elements.interaction);
          hide(elements.plans);
          if (elements.levels && elements.levels.classList) {
            elements.levels.classList.add('slide-in');
          }
          log('Entrou no Templo. Portais dispon√≠veis: Nv 0.');
        } catch (error) {
          console.error('Erro ao navegar para n√≠veis:', error);
        }
      }

      function startLevel0() {
        try {
          hide(elements.home);
          show(elements.levels);
          show(elements.interaction);
          hide(elements.plans);
          if (elements.interaction && elements.interaction.classList) {
            elements.interaction.classList.add('slide-in');
          }
          currentLevel = 0;
          updateBreadcrumb(0);
          safeSetText(elements.mirrorHeading, 'Nv 0 ‚Äî Eco dos Portais');
          safeSetText(elements.mirrorMsg, '"Bem-vindo, viajante das palavras. Este espelho reflete n√£o apenas sua imagem, mas a ess√™ncia de seus pensamentos. Sussurre seu primeiro verbo e descubra o que o eco revela."');
          hide(elements.pricing);
          log('Nv 0 ‚Äî Eco dos Portais iniciado.');
        } catch (error) {
          console.error('Erro ao iniciar n√≠vel 0:', error);
        }
      }

      function activateLevel1() {
        try {
          if (elements.p1) {
            elements.p1.classList.remove('locked');
            elements.p1.setAttribute('aria-label', 'Abrir Nv 01 ‚Äî Aprendiz das Letras');
            elements.p1.title = 'Portal dispon√≠vel - Aprendiz das Letras';
          }
          if (!unlockedLevels.includes(1)) {
            unlockedLevels.push(1);
          }
          currentLevel = 1;
          updateBreadcrumb(1);
          safeSetText(elements.mirrorHeading, 'Nv 01 ‚Äî Aprendiz das Letras');
          safeSetText(elements.mirrorMsg, '"As letras s√£o sementes de pensamento. Cada palavra que voc√™ escreve planta uma ideia no jardim da consci√™ncia. Continue cultivando."');
          hide(elements.pricing);
          hide(elements.plans);
          log('Nv 01 desbloqueado. Bem-vindo, Aprendiz das Letras.');
          showFeedback('Nv 01 desbloqueado! ‚ú®', 'info');
          openLevel(1);
        } catch (error) {
          console.error('Erro ao ativar n√≠vel 1:', error);
        }
      }

      function showPlans() {
        try {
          hide(elements.home);
          hide(elements.levels);
          show(elements.interaction);
          show(elements.plans);
          log('Abrindo p√°gina de planos.');
        } catch (error) {
          console.error('Erro ao mostrar planos:', error);
        }
      }

      function openLevel(levelNumber) {
        try {
          const levelData = levelsData.find((item) => item.lvl === levelNumber);
          if (!levelData) {
            return;
          }
          const cardMarkup = renderPlanCard(levelData);
          openModal(levelData.title, cardMarkup);
          show(elements.interaction);
          log(`Portal ${levelData.title} ‚Äî planos exibidos.`);
        } catch (error) {
          console.error('Erro ao abrir n√≠vel:', error);
        }
      }

      function openAllPlans() {
        try {
          const cards = levelsData.map((item) => renderPlanCard(item)).join('');
          const content = `
            <div class="pricing" style="grid-template-columns:repeat(auto-fit,minmax(260px,1fr))">
              ${cards}
            </div>
          `;
          openModal('Planos Sarvos', content);
          show(elements.interaction);
          log('Cat√°logo completo de planos exibido.');
        } catch (error) {
          console.error('Erro ao abrir cat√°logo completo de planos:', error);
        }
      }

      function addEventListeners() {
        if (listenersAttached) {
          return;
        }

        if (elements.goLevels) {
          elements.goLevels.addEventListener('click', goToLevels);
        }
        if (elements.startNv0) {
          elements.startNv0.addEventListener('click', startLevel0);
        }

        if (elements.p0) {
          elements.p0.addEventListener('click', () => {
            if (checkPortalAccess(0)) {
              openLevel(0);
            }
          });
        }
        if (elements.p1) {
          elements.p1.addEventListener('click', () => {
            if (checkPortalAccess(1)) {
              openLevel(1);
            }
          });
        }
        [elements.p2, elements.p3, elements.p4].forEach((portal) => {
          if (portal) {
            portal.addEventListener('click', () => {
              const level = parseInt(portal.dataset.level, 10);
              if (checkPortalAccess(level)) {
                openLevel(level);
              }
            });
          }
        });

        if (elements.startLv1) {
          elements.startLv1.addEventListener('click', activateLevel1);
        }
        if (elements.viewPlans) {
          elements.viewPlans.addEventListener('click', showPlans);
        }

        if (elements.send) {
          elements.send.addEventListener('click', createSendEffect);
        }

        if (elements.modalClose) {
          elements.modalClose.addEventListener('click', closeModal);
        }
        if (elements.modal) {
          elements.modal.addEventListener('click', (event) => {
            if (event.target === elements.modal) {
              closeModal();
            }
          });
        }

        const levelsTitle = document.querySelector('#levels .hd strong');
        if (levelsTitle) {
          levelsTitle.addEventListener('click', openAllPlans);
          levelsTitle.style.cursor = 'pointer';
        }

        document.querySelectorAll('.portal').forEach((portal) => {
          portal.addEventListener('keydown', (event) => {
            if (event.key === 'Enter' || event.key === ' ') {
              portal.click();
              event.preventDefault();
            }
          });
        });

        ['mic', 'pen', 'cam'].forEach((id) => {
          const control = document.getElementById(id);
          if (!control) {
            return;
          }
          control.setAttribute('aria-pressed', 'false');
          control.addEventListener('click', () => {
            const active = control.classList.toggle('toggle-active');
            control.setAttribute('aria-pressed', active ? 'true' : 'false');
            log(`${control.textContent.trim()} ${active ? 'ativado' : 'desativado'}.`);
          });
        });

        document.addEventListener('click', (event) => {
          const trigger = findClosest(event.target, '[data-plan]');
          if (!trigger) {
            return;
          }
          const plan = trigger.dataset.plan;
          log(`Plano ${plan} selecionado.`);
          closeModal();
          if (plan === 'nv0') {
            startLevel0();
          } else if (plan === 'nv1') {
            activateLevel1();
          }
        });

        if (window.matchMedia('(max-width: 720px)').matches && elements.mobileTabs) {
          elements.mobileTabs.style.display = 'flex';
          document.addEventListener('click', (event) => {
            const tabButton = findClosest(event.target, '[data-tab]');
            if (!tabButton) {
              return;
            }
            const tab = tabButton.dataset.tab;
            const mirrorCard = document.querySelector('#interaction [data-section="mirror"]');
            const grimCard = document.querySelector('#interaction [data-section="grimorio"]');
            if (mirrorCard && grimCard) {
              mirrorCard.style.display = tab === 'mirror' ? '' : 'none';
              grimCard.style.display = tab === 'grimorio' ? '' : 'none';
            }
          });
        }

        listenersAttached = true;
      }

      function addPulseToMainButton() {
        const mainButton = document.getElementById('startNv0');
        if (!mainButton) {
          return;
        }
        setTimeout(() => {
          mainButton.classList.add('pulse');
        }, 2000);
      }

      function init() {
        if (initialized) {
          return;
        }
        try {
          ensureAnimationStyles();
          initParticles();
          addEventListeners();
          initPortalBreathing();
          addPulseToMainButton();
          log('Sistema Sarvos inicializado com sucesso.');
          initialized = true;
        } catch (error) {
          console.error('Erro na inicializa√ß√£o:', error);
        }
      }

      function scheduleFallback() {
        setTimeout(() => {
          if (!initialized) {
            try {
              init();
            } catch (error) {
              console.error('Erro no fallback:', error);
            }
          }
        }, 100);
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
          init();
          scheduleFallback();
        });
      } else {
        init();
        scheduleFallback();
      }

      global.Logic = {
        init
      };
    }(window));
  </script>
</body>
</html>
